import{Z as G,c as J,C as M,O as Z,P as Q,w as W,D as X,I as Y,J as ee,_ as te,K as oe,L as se}from"./element-plus.4c84fed9.js";import{_ as ie}from"./index.vue_vue_type_script_setup_true_lang.9919777c.js";import{_ as ne}from"./index.vue_vue_type_script_setup_true_lang.a16a3292.js";import{u as ae}from"./usePaging.b71474b4.js";import{d as A,e as re,o as r,K as _,u as v,k as L,$ as D,r as le,G as ue,a4 as me,c as E,U as e,L as i,a as p,T as x,R as F,M as de,P as ce,S}from"./@vue.e8706010.js";import{_ as U}from"./lodash.ded75160.js";import{b as pe}from"./bookingDataService.bb879d20.js";import{u as I}from"./userService.af8f9970.js";import"./index.ce9653e5.js";import"./frontUsersList.vue_vue_type_script_setup_true_name_consumerLists_lang.f1711c63.js";import{_ as _e}from"./pickServicePerson.vue_vue_type_script_setup_true_lang.d6570db5.js";import{d as ve}from"./index.9623039f.js";import{d as fe}from"./dayjs.acb2afad.js";import"./@vueuse.1e5a6e21.js";import"./@element-plus.196c7323.js";import"./lodash-es.92e7f918.js";import"./async-validator.fb49d0f5.js";import"./@ctrl.82a509e0.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./axios.4ea15493.js";import"./consumer.a869df10.js";import"./servicePersonsList.vue_vue_type_script_setup_true_name_aServicePersonLists_lang.2f597507.js";import"./a_service_person.a4f0c1b4.js";import"./vue-router.12d45bc3.js";import"./pinia.dfca86b4.js";import"./vue-demi.ebc8116b.js";import"./css-color-function.c8e19b2b.js";import"./color.1121912c.js";import"./clone.9e59dbcb.js";import"./color-convert.755d189f.js";import"./color-name.e7a4e1d3.js";import"./color-string.e356f5de.js";import"./balanced-match.d2a36341.js";import"./debug.72cc5392.js";import"./ms.a9ae1d6d.js";import"./nprogress.2a2760db.js";import"./vue-clipboard3.38dbacbe.js";import"./clipboard.78d63871.js";import"./echarts.8d7a50ae.js";import"./zrender.1084fa23.js";import"./tslib.60310f1a.js";import"./highlight.js.4ebdf9a4.js";import"./@highlightjs.2cdc8407.js";const ge=A({__name:"timePicker",props:{startTime:{default:""},endTime:{default:""},rangeType:{default:"datetimerange"}},emits:["update:startTime","update:endTime"],setup(P,{emit:n}){const o=P,T=[new Date("2022-10-01 00:00:00"),new Date("2022-10-01 23:23:59")],f=re({get:()=>[o.startTime,o.endTime],set:g=>{g===null?(n("update:startTime",""),n("update:endTime","")):(n("update:startTime",g[0]),n("update:endTime",g[1]))}});return(g,l)=>{const k=G;return r(),_(k,{modelValue:v(f),"onUpdate:modelValue":l[0]||(l[0]=w=>L(f)?f.value=w:null),"is-range":"","range-separator":"-","start-placeholder":"\u5F00\u59CB\u65F6\u95F4","end-placeholder":"\u7ED3\u675F\u65F6\u95F4",clearable:"","default-value":T,"value-format":"HH:mm:ss"},null,8,["modelValue"])}}}),Fe={class:"popup-select-field-wrap"},ke={key:0,class:"has-value"},be={key:1,class:"no-value"},Ee={class:"cross-icon"},Se=S("\u67E5\u8BE2"),Te=S("\u91CD\u7F6E"),we={class:"mt-4"},Pe=S("\u5DF2\u5B8C\u6210"),Ce=S("\u5F85\u5B8C\u6210"),Be={key:2},he={class:"flex mt-4 justify-end"},ye=A({__name:"availableTickets",setup(P){const n=D({pickServicePersonShown:!1,pickedServicePerson:{service_person_id:"",name:""},isServicePersonLogin:!1}),o=D({service_person_id:"",booking_status:"",is_available:"-1",start:"",end:"",start_time:"",end_time:""}),T=le([]),f=a=>{T.value=a.map(({id:t})=>t)};(()=>{if(I.getUserRoleInfo("role_code")==="service_person_role"){n.isServicePersonLogin=!0;let a=I.getUserInfo("service_person_relations[0].service_person_id");a||(a="-1"),o.service_person_id=a}else o.service_person_id="",n.isServicePersonLogin=!1})();const{pager:l,getLists:k,resetParams:w,resetPage:R}=ae({fetchFun:pe.apiAViewTicketRelatedLists,params:o}),$=(a=[])=>{const t=U.get(a,"[0]")||{};Object.assign(n.pickedServicePerson,t),o.service_person_id=U.get(t,"id")||"",n.pickServicePersonShown=!1},C=()=>{o.service_person_id="",n.pickedServicePerson={service_person_id:"",name:""}},N=()=>{C(),w()},b=(a="")=>{let t="\u4E0A\u5348";const u=fe(a).format("H")||8;return 6<=u&&u<=12?t="\u4E0A\u5348":12<u&&u<=18?t="\u4E0B\u5348":18<u&&u<=23&&(t="\u665A\u4E0A"),t};return ue(()=>{n.isServicePersonLogin=!1,o.service_person_id=""}),k(),(a,t)=>{const u=me("CircleCloseFilled"),j=J,m=M,d=Z,B=Q,H=ne,h=W,O=X,y=Y,c=ee,V=te,K=oe,q=ie,z=se;return r(),E("div",null,[e(y,{class:"!border-none mb-4",shadow:"never"},{default:i(()=>[e(O,{class:"mb-[-16px]",model:o,inline:""},{default:i(()=>[n.isServicePersonLogin?F("",!0):(r(),_(m,{key:0,label:"\u53F7\u6E90\u63D0\u4F9B\u8005",prop:"service_person_id"},{default:i(()=>[p("div",Fe,[p("div",{class:"popup-select-field",onClick:t[0]||(t[0]=s=>n.pickServicePersonShown=!0)},[n.pickedServicePerson.name?(r(),E("span",ke,x(n.pickedServicePerson.name),1)):(r(),E("span",be,"\u8BF7\u9009\u62E9"))]),p("div",Ee,[e(j,{onClick:C},{default:i(()=>[e(u)]),_:1})])])]),_:1})),e(m,{label:"\u53F7\u6E90\u72B6\u6001"},{default:i(()=>[e(B,{class:"w-[100px]",modelValue:o.booking_status,"onUpdate:modelValue":t[1]||(t[1]=s=>o.booking_status=s)},{default:i(()=>[e(d,{label:"\u5168\u90E8",value:""}),e(d,{label:"\u5F85\u5B8C\u6210",value:"pending"}),e(d,{label:"\u5DF2\u5B8C\u6210",value:"confirmed"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"\u53F7\u6E90\u53EF\u7528"},{default:i(()=>[e(B,{class:"w-[100px]",modelValue:o.is_available,"onUpdate:modelValue":t[2]||(t[2]=s=>o.is_available=s)},{default:i(()=>[e(d,{label:"\u5168\u90E8",value:"-1"}),e(d,{label:"\u53EF\u7528",value:"1"}),e(d,{label:"\u4E0D\u53EF\u7528",value:"0"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"\u65E5\u671F\u8DE8\u5EA6"},{default:i(()=>[e(H,{startTime:o.start,"onUpdate:startTime":t[3]||(t[3]=s=>o.start=s),endTime:o.end,"onUpdate:endTime":t[4]||(t[4]=s=>o.end=s),rangeType:"daterange"},null,8,["startTime","endTime"])]),_:1}),e(m,{label:"\u6BCF\u5929\u65F6\u6BB5"},{default:i(()=>[e(ge,{startTime:o.start_time,"onUpdate:startTime":t[5]||(t[5]=s=>o.start_time=s),endTime:o.end_time,"onUpdate:endTime":t[6]||(t[6]=s=>o.end_time=s)},null,8,["startTime","endTime"])]),_:1}),e(m,null,{default:i(()=>[e(h,{type:"primary",onClick:v(R)},{default:i(()=>[Se]),_:1},8,["onClick"]),e(h,{onClick:N},{default:i(()=>[Te]),_:1}),F("",!0)]),_:1})]),_:1},8,["model"])]),_:1}),de((r(),_(y,{class:"!border-none",shadow:"never"},{default:i(()=>[p("div",we,[e(K,{data:v(l).lists,onSelectionChange:f},{default:i(()=>[e(c,{label:"\u5E8F\u53F7",type:"index",width:"60"}),e(c,{label:"\u53F7\u6E90\u63D0\u4F9B",prop:"servicePersonName","show-overflow-tooltip":""}),e(c,{label:"\u53F7\u6E90\u65F6\u95F4",prop:"service_time",width:"180"}),e(c,{label:"\u65F6\u6BB5",prop:"service_time",width:"180"},{default:i(s=>[p("div",{class:ce({morning:b(s.row.service_time)=="\u4E0A\u5348",afternoon:b(s.row.service_time)=="\u4E0B\u5348",evening:b(s.row.service_time)=="\u665A\u4E0A"})},x(b(s.row.service_time)),3)]),_:1}),e(c,{label:"\u53F7\u6E90\u72B6\u6001",prop:"booking_status","show-overflow-tooltip":""},{default:i(s=>[s.row.booking_status==="confirmed"?(r(),_(V,{key:0,type:"warning"},{default:i(()=>[Pe]),_:1})):F("",!0),s.row.booking_status==="pending"?(r(),_(V,{key:1,type:"warning"},{default:i(()=>[Ce]),_:1})):(r(),E("div",Be))]),_:1}),e(c,{label:"\u9884\u7EA6\u53EF\u5EF6\u8FDF\uFF08\u5206\u949F\uFF09",prop:"booking_minutes_delay","show-overflow-tooltip":""}),F("",!0)]),_:1},8,["data"])]),p("div",he,[e(q,{modelValue:v(l),"onUpdate:modelValue":t[7]||(t[7]=s=>L(l)?l.value=s:null),onChange:v(k)},null,8,["modelValue","onChange"])])]),_:1})),[[z,v(l).loading]]),n.pickServicePersonShown?(r(),_(_e,{key:0,onClose:$})):F("",!0)])}}});const Et=ve(ye,[["__scopeId","data-v-23890e7f"]]);export{Et as default};

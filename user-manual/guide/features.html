<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>功能 | PV预约系统 说明文档</title>
    <meta name="description" content="PV预约系统-适合`美甲店`, `私人诊所`，`医馆`等需要先预约后服务的单位使用">
    <link rel="stylesheet" href="/booking/user-manual/assets/style.83523d50.css">
    <link rel="modulepreload" href="/booking/user-manual/assets/app.a7a08ac0.js">
    <link rel="modulepreload" href="/booking/user-manual/assets/guide_features.md.55ece322.lean.js">
    
    <script>(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-92a6092e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-300bcde0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-300bcde0> Skip to content </a><!--]--><!----><header class="VPNav" data-v-92a6092e data-v-340c8be8><div class="VPNavBar has-sidebar" data-v-340c8be8 data-v-1ec741f7><div class="container" data-v-1ec741f7><div class="VPNavBarTitle has-sidebar" data-v-1ec741f7 data-v-66c4cd45><a class="title" href="/booking/user-manual/" data-v-66c4cd45><!----><!--[-->PV预约系统 说明文档<!--]--></a></div><div class="content" data-v-1ec741f7><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-1ec741f7 data-v-9b61be6e><span id="main-nav-aria-label" class="visually-hidden" data-v-9b61be6e>Main Navigation</span><!--[--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-1ec741f7 data-v-b6b11b72><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-b6b11b72 data-v-69ff704a data-v-33b789dc><span class="check" data-v-33b789dc><span class="icon" data-v-33b789dc><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-69ff704a><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-69ff704a><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-1ec741f7 data-v-de480392 data-v-875b79ba><!--[--><a class="VPSocialLink" href="https://github.com/cancms/booking" title="github" target="_blank" rel="noopener noreferrer" data-v-875b79ba data-v-673bcc94><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-673bcc94><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="visually-hidden" data-v-673bcc94>github</span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-1ec741f7 data-v-1321f080 data-v-236ed7fc><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-236ed7fc><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-236ed7fc><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-236ed7fc><div class="VPMenu" data-v-236ed7fc data-v-386c8c22><!----><!--[--><!--[--><!----><div class="group" data-v-1321f080><div class="item appearance" data-v-1321f080><p class="label" data-v-1321f080>Appearance</p><div class="appearance-action" data-v-1321f080><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-1321f080 data-v-69ff704a data-v-33b789dc><span class="check" data-v-33b789dc><span class="icon" data-v-33b789dc><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-69ff704a><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-69ff704a><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-1321f080><div class="item social-links" data-v-1321f080><div class="VPSocialLinks social-links-list" data-v-1321f080 data-v-875b79ba><!--[--><a class="VPSocialLink" href="https://github.com/cancms/booking" title="github" target="_blank" rel="noopener noreferrer" data-v-875b79ba data-v-673bcc94><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-673bcc94><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg><span class="visually-hidden" data-v-673bcc94>github</span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-1ec741f7 data-v-e8a849d6><span class="container" data-v-e8a849d6><span class="top" data-v-e8a849d6></span><span class="middle" data-v-e8a849d6></span><span class="bottom" data-v-e8a849d6></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-92a6092e data-v-47dcdbca><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-47dcdbca><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-47dcdbca><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-47dcdbca>Menu</span></button><a class="top-link" href="#" data-v-47dcdbca> Return to top </a></div><aside class="VPSidebar" data-v-92a6092e data-v-c0a77aca><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-c0a77aca><span class="visually-hidden" id="sidebar-aria-label" data-v-c0a77aca> Sidebar Navigation </span><!--[--><div class="group" data-v-c0a77aca><section class="VPSidebarGroup" data-v-c0a77aca data-v-14b9c2ad><div class="title" data-v-14b9c2ad><h2 class="title-text" data-v-14b9c2ad>使用说明</h2><div class="action" data-v-14b9c2ad><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-14b9c2ad><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-14b9c2ad><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-14b9c2ad><!--[--><a class="VPLink link" href="/booking/user-manual/guide/booking/intro.html" data-v-14b9c2ad data-v-d0e9e1de data-v-26293d92><!--[--><span class="link-text" data-v-d0e9e1de>系统介绍</span><!--]--><!----></a><a class="VPLink link" href="/booking/user-manual/guide/booking/concept.html" data-v-14b9c2ad data-v-d0e9e1de data-v-26293d92><!--[--><span class="link-text" data-v-d0e9e1de>了解概念</span><!--]--><!----></a><a class="VPLink link" href="/booking/user-manual/guide/booking/features.html" data-v-14b9c2ad data-v-d0e9e1de data-v-26293d92><!--[--><span class="link-text" data-v-d0e9e1de>系统功能</span><!--]--><!----></a><a class="VPLink link" href="/booking/user-manual/guide/booking/start-using.html" data-v-14b9c2ad data-v-d0e9e1de data-v-26293d92><!--[--><span class="link-text" data-v-d0e9e1de>开始使用</span><!--]--><!----></a><a class="VPLink link" href="/booking/user-manual/guide/booking/demo-image.html" data-v-14b9c2ad data-v-d0e9e1de data-v-26293d92><!--[--><span class="link-text" data-v-d0e9e1de>系统展示</span><!--]--><!----></a><a class="VPLink link" href="/booking/user-manual/guide/booking/other-info.html" data-v-14b9c2ad data-v-d0e9e1de data-v-26293d92><!--[--><span class="link-text" data-v-d0e9e1de>其它说明</span><!--]--><!----></a><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-92a6092e data-v-37403dbd><div class="VPDoc has-sidebar" data-v-37403dbd data-v-6f5051a0><div class="container" data-v-6f5051a0><div class="aside" data-v-6f5051a0><div class="aside-curtain" data-v-6f5051a0></div><div class="aside-container" data-v-6f5051a0><div class="aside-content" data-v-6f5051a0><div class="VPDocAside" data-v-6f5051a0 data-v-4889908d><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-4889908d data-v-1322d3e4><div class="content" data-v-1322d3e4><div class="outline-marker" data-v-1322d3e4></div><div class="outline-title" data-v-1322d3e4>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-1322d3e4><span class="visually-hidden" id="doc-outline-aria-label" data-v-1322d3e4> Table of Contents for current page </span><ul class="root" data-v-1322d3e4><!--[--><li style="" data-v-1322d3e4><a class="outline-link" href="#npm-dependency-resolving-and-pre-bundling" data-v-1322d3e4>NPM 依赖解析和预构建</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#hot-module-replacement" data-v-1322d3e4>模块热替换</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#typescript" data-v-1322d3e4>TypeScript</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#vue" data-v-1322d3e4>Vue</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#jsx" data-v-1322d3e4>JSX</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#css" data-v-1322d3e4>CSS</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#static-assets" data-v-1322d3e4>静态资源处理</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#json" data-v-1322d3e4>JSON</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#glob-import" data-v-1322d3e4>Glob 导入</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#dynamic-import" data-v-1322d3e4>动态导入</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#webassembly" data-v-1322d3e4>WebAssembly</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#web-workers" data-v-1322d3e4>Web Workers</a><!----></li><li style="" data-v-1322d3e4><a class="outline-link" href="#build-optimizations" data-v-1322d3e4>构建优化</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-4889908d></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6f5051a0><div class="content-container" data-v-6f5051a0><!--[--><!--]--><main class="main" data-v-6f5051a0><div style="position:relative;" class="vp-doc _booking_user-manual_guide_features" data-v-6f5051a0><div><h1 id="features" tabindex="-1">功能 <a class="header-anchor" href="#features">¶</a></h1><p>对非常基础的使用来说，使用 Vite 开发和使用一个静态文件服务器并没有太大区别。然而，Vite 还通过原生 ESM 导入提供了许多主要用于打包场景的增强功能。</p><h2 id="npm-dependency-resolving-and-pre-bundling" tabindex="-1">NPM 依赖解析和预构建 <a class="header-anchor" href="#npm-dependency-resolving-and-pre-bundling">¶</a></h2><p>原生 ES 导入不支持下面这样的裸模块导入：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">someMethod</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">my-dep</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><p>上面的代码会在浏览器中抛出一个错误。Vite 将会检测到所有被加载的源文件中的此类裸模块导入，并执行以下操作:</p><ol><li><p><a href="./dep-pre-bundling.html">预构建</a> 它们可以提高页面加载速度，并将 CommonJS / UMD 转换为 ESM 格式。预构建这一步由 <a href="http://esbuild.github.io/" target="_blank" rel="noopener noreferrer">esbuild</a> 执行，这使得 Vite 的冷启动时间比任何基于 JavaScript 的打包器都要快得多。</p></li><li><p>重写导入为合法的 URL，例如 <code>/node_modules/.vite/deps/my-dep.js?v=f3sf2ebd</code> 以便浏览器能够正确导入它们。</p></li></ol><p><strong>依赖是强缓存的</strong></p><p>Vite 通过 HTTP 头来缓存请求得到的依赖，所以如果你想要编辑或调试一个依赖，请按照 <a href="./dep-pre-bundling.html#浏览器缓存">这里</a> 的步骤操作。</p><h2 id="hot-module-replacement" tabindex="-1">模块热替换 <a class="header-anchor" href="#hot-module-replacement">¶</a></h2><p>Vite 提供了一套原生 ESM 的 <a href="./api-hmr.html">HMR API</a>。 具有 HMR 功能的框架可以利用该 API 提供即时、准确的更新，而无需重新加载页面或清除应用程序状态。Vite 内置了 HMR 到 <a href="https://github.com/vitejs/vite/tree/main/packages/plugin-vue" target="_blank" rel="noopener noreferrer">Vue 单文件组件（SFC）</a> 和 <a href="https://github.com/vitejs/vite/tree/main/packages/plugin-react" target="_blank" rel="noopener noreferrer">React Fast Refresh</a> 中。也通过 <a href="https://github.com/JoviDeCroock/prefresh/tree/main/packages/vite" target="_blank" rel="noopener noreferrer">@prefresh/vite</a> 对 Preact 实现了官方集成。</p><p>注意，你不需要手动设置这些 —— 当你通过 <a href="./"><code>create-vite</code></a> 创建应用程序时，所选模板已经为你预先配置了这些。</p><h2 id="typescript" tabindex="-1">TypeScript <a class="header-anchor" href="#typescript">¶</a></h2><p>Vite 天然支持引入 <code>.ts</code> 文件。</p><p>Vite 仅执行 <code>.ts</code> 文件的转译工作，并 <strong>不</strong> 执行任何类型检查。并假设类型检查已经被你的 IDE 或构建过程接管了（你可以在构建脚本中运行 <code>tsc --noEmit</code> 或者安装 <code>vue-tsc</code> 然后运行 <code>vue-tsc --noEmit</code> 来对你的 <code>*.vue</code> 文件做类型检查）。</p><p>Vite 使用 <a href="https://github.com/evanw/esbuild" target="_blank" rel="noopener noreferrer">esbuild</a> 将 TypeScript 转译到 JavaScript，约是 <code>tsc</code> 速度的 20~30 倍，同时 HMR 更新反映到浏览器的时间小于 50ms。</p><p>使用 <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-8.html#type-only-imports-and-export" target="_blank" rel="noopener noreferrer">仅含类型的导入和导出</a> 形式的语法可以避免潜在的 “仅含类型的导入被不正确打包” 的问题，写法示例如下：</p><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">T</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">only/types</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">T</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="typescript-compiler-options" tabindex="-1">TypeScript 编译器选项 <a class="header-anchor" href="#typescript-compiler-options">¶</a></h3><p><code>tsconfig.json</code> 中 <code>compilerOptions</code> 下的一些配置项需要特别注意。</p><h4 id="isolatedmodules" tabindex="-1"><code>isolatedModules</code> <a class="header-anchor" href="#isolatedmodules">¶</a></h4><p>应该设置为 <code>true</code>。</p><p>这是因为 <code>esbuild</code> 只执行没有类型信息的转译，它并不支持某些特性，如 <code>const enum</code> 和隐式类型导入。</p><p>你必须在 <code>tsconfig.json</code> 中的 <code>compilerOptions</code> 下设置 <code>&quot;isolatedModules&quot;: true</code>。如此做，TS 会警告你不要使用隔离（isolated）转译的功能。</p><p>然而，一些库（如：<a href="https://github.com/vuejs/core/issues/1228" target="_blank" rel="noopener noreferrer"><code>vue</code></a>）不能很好地与 <code>&quot;isolatedModules&quot;: true</code> 共同工作。你可以在上游仓库修复好之前暂时使用 <code>&quot;skipLibCheck&quot;: true</code> 来缓解这个错误。</p><h4 id="usedefineforclassfields" tabindex="-1"><code>useDefineForClassFields</code> <a class="header-anchor" href="#usedefineforclassfields">¶</a></h4><p>从 Vite v2.5.0 开始，如果 TypeScript 的 target 是 <code>ES2022</code> 或更高，包括 <code>ESNext</code>，则此选项默认值为 <code>true</code>。这与 <a href="https://github.com/microsoft/TypeScript/pull/42663" target="_blank" rel="noopener noreferrer"><code>tsc</code> v4.3.2 及以后版本的行为</a> 一致。这也是标准的 ECMAScript 的运行时行为。</p><p>但对于那些习惯其他编程语言或旧版本 TypeScript 的开发者来说，这可能是违反直觉的。 你可以参阅 <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#the-usedefineforclassfields-flag-and-the-declare-property-modifier" target="_blank" rel="noopener noreferrer">TypeScript 3.7 发布日志</a> 中了解更多关于如何兼容的信息。</p><p>如果你正在使用一个严重依赖 class fields 的库，请注意该库对此选项的预期设置。</p><p>大多数库都希望 <code>&quot;useDefineForClassFields&quot;: true</code>，如 <a href="https://mobx.js.org/installation.html#use-spec-compliant-transpilation-for-class-properties" target="_blank" rel="noopener noreferrer">MobX</a>，<a href="https://github.com/vuejs/vue-class-component/issues/465" target="_blank" rel="noopener noreferrer">Vue Class Components 8.x</a> 等。</p><p>但是有几个库还没有兼容这个新的默认值，其中包括 <a href="https://github.com/lit/lit-element/issues/1030" target="_blank" rel="noopener noreferrer"><code>lit-element</code></a>。如果遇到这种情况，请将 <code>useDefineForClassFields</code> 设置为 <code>false</code>。</p><h4 id="other-compiler-options-affecting-the-build-result" tabindex="-1">影响构建结果的其他编译器选项 <a class="header-anchor" href="#other-compiler-options-affecting-the-build-result">¶</a></h4><ul><li><a href="https://www.typescriptlang.org/tsconfig#extends" target="_blank" rel="noopener noreferrer"><code>extends</code></a></li><li><a href="https://www.typescriptlang.org/tsconfig#alwaysStrict" target="_blank" rel="noopener noreferrer"><code>alwaysStrict</code></a></li><li><a href="https://www.typescriptlang.org/tsconfig#importsNotUsedAsValues" target="_blank" rel="noopener noreferrer"><code>importsNotUsedAsValues</code></a></li><li><a href="https://www.typescriptlang.org/tsconfig#jsx" target="_blank" rel="noopener noreferrer"><code>jsx</code></a></li><li><a href="https://www.typescriptlang.org/tsconfig#jsxFactory" target="_blank" rel="noopener noreferrer"><code>jsxFactory</code></a></li><li><a href="https://www.typescriptlang.org/tsconfig#jsxFragmentFactory" target="_blank" rel="noopener noreferrer"><code>jsxFragmentFactory</code></a></li><li><a href="https://www.typescriptlang.org/tsconfig#jsxImportSource" target="_blank" rel="noopener noreferrer"><code>jsxImportSource</code></a></li><li><a href="https://www.typescriptlang.org/tsconfig#preserveValueImports" target="_blank" rel="noopener noreferrer"><code>preserveValueImports</code></a></li></ul><p>如果你的代码库很难迁移到 <code>&quot;isolatedModules&quot;: true</code>，或许你可以尝试通过第三方插件来解决，比如 <a href="https://www.npmjs.com/package/rollup-plugin-friendly-type-imports" target="_blank" rel="noopener noreferrer">rollup-plugin-friendly-type-imports</a>。但是，这种方式不被 Vite 官方支持。</p><h3 id="client-types" tabindex="-1">客户端类型 <a class="header-anchor" href="#client-types">¶</a></h3><p>Vite 默认的类型定义是写给它的 Node.js API 的。要将其补充到一个 Vite 应用的客户端代码环境中，请添加一个 <code>d.ts</code> 声明文件：</p><div class="language-typescript"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#89DDFF;font-style:italic;">&lt;</span><span style="color:#F07178;font-style:italic;">reference</span><span style="color:#89DDFF;font-style:italic;"> </span><span style="color:#C792EA;font-style:italic;">types</span><span style="color:#89DDFF;font-style:italic;">=</span><span style="color:#89DDFF;font-style:italic;">&quot;</span><span style="color:#C3E88D;font-style:italic;">vite/client</span><span style="color:#89DDFF;font-style:italic;">&quot;</span><span style="color:#89DDFF;font-style:italic;"> /&gt;</span></span>
<span class="line"></span></code></pre></div><p>同时，你也可以将 <code>vite/client</code> 添加到 <code>tsconfig</code> 中的 <code>compilerOptions.types</code> 下：</p><div class="language-json"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">compilerOptions</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">types</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vite/client</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>这将会提供以下类型定义补充：</p><ul><li>资源导入 (例如：导入一个 <code>.svg</code> 文件)</li><li><code>import.<wbr>meta.env</code> 上 Vite 注入的环境变量的类型定义</li><li><code>import.<wbr>meta.hot</code> 上的 <a href="./api-hmr.html">HMR API</a> 类型定义</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>要覆盖默认的类型定义，请在三斜线注释前添加定义。例如，要为 React 组件中的 <code>*.svg</code> 文件定义类型：</p><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">declare</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">module</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*.svg</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">content</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">FC</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">React</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">SVGProps</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">SVGElement</span><span style="color:#89DDFF;">&gt;&gt;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">content</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#89DDFF;font-style:italic;">&lt;</span><span style="color:#F07178;font-style:italic;">reference</span><span style="color:#89DDFF;font-style:italic;"> </span><span style="color:#C792EA;font-style:italic;">types</span><span style="color:#89DDFF;font-style:italic;">=</span><span style="color:#89DDFF;font-style:italic;">&quot;</span><span style="color:#C3E88D;font-style:italic;">vite/client</span><span style="color:#89DDFF;font-style:italic;">&quot;</span><span style="color:#89DDFF;font-style:italic;"> /&gt;</span></span>
<span class="line"></span></code></pre></div></div><h2 id="vue" tabindex="-1">Vue <a class="header-anchor" href="#vue">¶</a></h2><p>Vite 为 Vue 提供第一优先级支持：</p><ul><li>Vue 3 单文件组件支持：<a href="https://github.com/vitejs/vite/tree/main/packages/plugin-vue" target="_blank" rel="noopener noreferrer">@vitejs/plugin-vue</a></li><li>Vue 3 JSX 支持：<a href="https://github.com/vitejs/vite/tree/main/packages/plugin-vue-jsx" target="_blank" rel="noopener noreferrer">@vitejs/plugin-vue-jsx</a></li><li>Vue 2.7 支持：<a href="https://github.com/vitejs/vite-plugin-vue2" target="_blank" rel="noopener noreferrer">@vitejs/vite-plugin-vue2</a></li><li>Vue &lt;2.7 的支持：<a href="https://github.com/underfin/vite-plugin-vue2" target="_blank" rel="noopener noreferrer">underfin/vite-plugin-vue2</a></li></ul><h2 id="jsx" tabindex="-1">JSX <a class="header-anchor" href="#jsx">¶</a></h2><p><code>.jsx</code> 和 <code>.tsx</code> 文件同样开箱即用。JSX 的转译同样是通过 <a href="https://esbuild.github.io" target="_blank" rel="noopener noreferrer">esbuild</a>。</p><p>Vue 用户应使用官方提供的 <a href="https://github.com/vitejs/vite/tree/main/packages/plugin-vue-jsx" target="_blank" rel="noopener noreferrer">@vitejs/plugin-vue-jsx</a> 插件，它提供了 Vue 3 特性的支持，包括 HMR，全局组件解析，指令和插槽。</p><p>如果不是在 React 或 Vue 中使用 JSX，自定义的 <code>jsxFactory</code> 和 <code>jsxFragment</code> 可以使用 <a href="/booking/user-manual/config/shared-options.html#esbuild"><code>esbuild</code> 选项</a> 进行配置。例如对 Preact：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite.config.js</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">defineConfig</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">defineConfig</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">esbuild</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">jsxFactory</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">h</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">jsxFragment</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Fragment</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>更多细节详见 <a href="https://esbuild.github.io/content-types/#jsx" target="_blank" rel="noopener noreferrer">esbuild 文档</a>.</p><p>你可以使用 <code>jsxInject</code>（这是一个仅在 Vite 中使用的选项）为 JSX 注入 helper，以避免手动导入：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite.config.js</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">defineConfig</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">defineConfig</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">esbuild</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">jsxInject</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">import React from &#39;react&#39;</span><span style="color:#89DDFF;">`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="css" tabindex="-1">CSS <a class="header-anchor" href="#css">¶</a></h2><p>导入 <code>.css</code> 文件将会把内容插入到 <code>&lt;style&gt;</code> 标签中，同时也带有 HMR 支持。也能够以字符串的形式检索处理后的、作为其模块默认导出的 CSS。</p><h3 id="import-inlining-and-rebasing" tabindex="-1"><code>@import</code> 内联和变基 <a class="header-anchor" href="#import-inlining-and-rebasing">¶</a></h3><p>Vite 通过 <code>postcss-import</code> 预配置支持了 CSS <code>@import</code> 内联，Vite 的路径别名也遵从 CSS <code>@import</code>。换句话说，所有 CSS <code>url()</code> 引用，即使导入的文件在不同的目录中，也总是自动变基，以确保正确性。</p><p>Sass 和 Less 文件也支持 <code>@import</code> 别名和 URL 变基（具体请参阅 <a href="#css-pre-processors">CSS Pre-processors</a>）。</p><h3 id="postcss" tabindex="-1">PostCSS <a class="header-anchor" href="#postcss">¶</a></h3><p>如果项目包含有效的 PostCSS 配置 (任何受 <a href="https://github.com/postcss/postcss-load-config" target="_blank" rel="noopener noreferrer">postcss-load-config</a> 支持的格式，例如 <code>postcss.config.js</code>)，它将会自动应用于所有已导入的 CSS。</p><h3 id="css-modules" tabindex="-1">CSS Modules <a class="header-anchor" href="#css-modules">¶</a></h3><p>任何以 <code>.module.css</code> 为后缀名的 CSS 文件都被认为是一个 <a href="https://github.com/css-modules/css-modules" target="_blank" rel="noopener noreferrer">CSS modules 文件</a>。导入这样的文件会返回一个相应的模块对象：</p><div class="language-css"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">/* example.module.css */</span></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">red</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> red</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> classes </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./example.module.css</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">className </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> classes</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">red</span></span>
<span class="line"></span></code></pre></div><p>CSS modules 行为可以通过 <a href="/booking/user-manual/config/shared-options.html#css-modules"><code>css.modules</code> 选项</a> 进行配置。</p><p>如果 <code>css.modules.localsConvention</code> 设置开启了 camelCase 格式变量名转换（例如 <code>localsConvention: &#39;camelCaseOnly&#39;</code>），你还可以使用按名导入。</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// .apply-color -&gt; applyColor</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">applyColor</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./example.module.css</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">foo</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">className </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> applyColor</span></span>
<span class="line"></span></code></pre></div><h3 id="css-pre-processors" tabindex="-1">CSS 预处理器 <a class="header-anchor" href="#css-pre-processors">¶</a></h3><p>由于 Vite 的目标仅为现代浏览器，因此建议使用原生 CSS 变量和实现 CSSWG 草案的 PostCSS 插件（例如 <a href="https://github.com/csstools/postcss-plugins/tree/main/plugins/postcss-nesting" target="_blank" rel="noopener noreferrer">postcss-nesting</a>）来编写简单的、符合未来标准的 CSS。</p><p>话虽如此，但 Vite 也同时提供了对 <code>.scss</code>, <code>.sass</code>, <code>.less</code>, <code>.styl</code> 和 <code>.stylus</code> 文件的内置支持。没有必要为它们安装特定的 Vite 插件，但必须安装相应的预处理器依赖：</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># .scss and .sass</span></span>
<span class="line"><span style="color:#A6ACCD;">npm add -D sass</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># .less</span></span>
<span class="line"><span style="color:#A6ACCD;">npm add -D less</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># .styl and .stylus</span></span>
<span class="line"><span style="color:#A6ACCD;">npm add -D stylus</span></span>
<span class="line"></span></code></pre></div><p>如果使用的是单文件组件，可以通过 <code>&lt;style lang=&quot;sass&quot;&gt;</code>（或其他预处理器）自动开启。</p><p>Vite 为 Sass 和 Less 改进了 <code>@import</code> 解析，以保证 Vite 别名也能被使用。另外，<code>url()</code> 中的相对路径引用的，与根文件不同目录中的 Sass/Less 文件会自动变基以保证正确性。</p><p>由于 Stylus API 限制，<code>@import</code> 别名和 URL 变基不支持 Stylus。</p><p>你还可以通过在文件扩展名前加上 <code>.module</code> 来结合使用 CSS modules 和预处理器，例如 <code>style.module.scss</code>。</p><h3 id="disabling-css-injection-into-the-page" tabindex="-1">禁用 CSS 注入页面 <a class="header-anchor" href="#disabling-css-injection-into-the-page">¶</a></h3><p>自动注入 CSS 内容的行为可以通过 <code>?inline</code> 参数来关闭。在关闭时，被处理过的 CSS 字符串将会作为该模块的默认导出，但样式并没有被注入到页面中。</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> styles </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./foo.css</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 样式将会注入页面</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> otherStyles </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./bar.css?inline</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 样式不会注入页面</span></span>
<span class="line"></span></code></pre></div><h2 id="static-assets" tabindex="-1">静态资源处理 <a class="header-anchor" href="#static-assets">¶</a></h2><p>导入一个静态资源会返回解析后的 URL：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> imgUrl </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./img.png</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getElementById</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hero-img</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">src </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> imgUrl</span></span>
<span class="line"></span></code></pre></div><p>添加一些特殊的查询参数可以更改资源被引入的方式：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// 显式加载资源为一个 URL</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> assetAsURL </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./asset.js?url</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// 以字符串形式加载资源</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> assetAsString </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./shader.glsl?raw</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// 加载为 Web Worker</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> Worker </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./worker.js?worker</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// 在构建时 Web Worker 内联为 base64 字符串</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> InlineWorker </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./worker.js?worker&amp;inline</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><p>更多细节请见 <a href="./assets.html">静态资源处理</a>。</p><h2 id="json" tabindex="-1">JSON <a class="header-anchor" href="#json">¶</a></h2><p>JSON 可以被直接导入 —— 同样支持具名导入：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// 导入整个对象</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> json </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./example.json</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 对一个根字段使用具名导入 —— 有效帮助 treeshaking！</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">field</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./example.json</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><h2 id="glob-import" tabindex="-1">Glob 导入 <a class="header-anchor" href="#glob-import">¶</a></h2><p>Vite 支持使用特殊的 <code>import.<wbr>meta.glob</code> 函数从文件系统导入多个模块：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">glob</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/*.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>以上将会被转译为下面的样子：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite 生成的代码</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>你可以遍历 <code>modules</code> 对象的 key 值来访问相应的模块：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> (</span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> modules) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">modules</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">path</span><span style="color:#F07178;">]()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">mod</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">mod</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>匹配到的文件默认是懒加载的，通过动态导入实现，并会在构建时分离为独立的 chunk。如果你倾向于直接引入所有的模块（例如依赖于这些模块中的副作用首先被应用），你可以传入 <code>{ eager: true }</code> 作为第二个参数：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">glob</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/*.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">eager</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>以上会被转译为下面的样子：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite 生成的代码</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> __glob__0_0 </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> __glob__0_1 </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> __glob__0_0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> __glob__0_1</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="glob-import-as" tabindex="-1">Glob 导入形式 <a class="header-anchor" href="#glob-import-as">¶</a></h3><p><code>import.<wbr>meta.glob</code> 都支持以字符串形式导入文件，类似于 <a href="https://vitejs.dev/guide/assets.html#importing-asset-as-string" target="_blank" rel="noopener noreferrer">以字符串形式导入资源</a>。在这里，我们使用了 <a href="https://github.com/tc39/proposal-import-reflection" target="_blank" rel="noopener noreferrer">Import Reflection</a> 语法对导入进行断言：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">glob</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/*.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">as</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">raw</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>上面的代码会被转换为下面这样：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// code produced by vite（代码由 vite 输出）</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">export default &quot;foo&quot;</span><span style="color:#A6ACCD;">\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">export default &quot;bar&quot;</span><span style="color:#A6ACCD;">\n</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p><code>{ as: &#39;url&#39; }</code> 还支持将资源作为 URL 加载。</p><h3 id="multiple-patterns" tabindex="-1">多个匹配模式 <a class="header-anchor" href="#multiple-patterns">¶</a></h3><p>第一个参数可以是一个 glob 数组，例如：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">glob</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/*.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./another/*.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">])</span></span>
<span class="line"></span></code></pre></div><h3 id="negative-patterns" tabindex="-1">反面匹配模式 <a class="header-anchor" href="#negative-patterns">¶</a></h3><p>同样也支持反面 glob 匹配模式（以 <code>!</code> 作为前缀）。若要忽略结果中的一些文件，你可以添加“排除匹配模式”作为第一个参数：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">glob</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/*.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">!**/bar.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">])</span></span>
<span class="line"></span></code></pre></div><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite 生成的代码</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="named-imports" tabindex="-1">具名导入 <a class="header-anchor" href="#named-imports">¶</a></h4><p>也可能你只想要导入模块中的部分内容，那么可以利用 <code>import</code> 选项。</p><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">glob</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/*.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">import</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">setup</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite 生成的代码</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">m</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> m</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">setup)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">m</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> m</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">setup)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>当与 <code>eager</code> 一同存在时，甚至可以对这些模块进行 tree-shaking。</p><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">glob</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/*.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">import</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">setup</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">eager</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite 生成的代码</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setup</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">__glob__0_0</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setup</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">__glob__0_1</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> __glob__0_0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> __glob__0_1</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>设置 <code>import</code> 为 <code>default</code> 可以加载默认导出。</p><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">glob</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/*.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">import</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">default</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">eager</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite 生成的代码</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> __glob__0_0 </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> __glob__0_1 </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> __glob__0_0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> __glob__0_1</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h4 id="custom-queries" tabindex="-1">自定义查询 <a class="header-anchor" href="#custom-queries">¶</a></h4><p>你也可以使用 <code>query</code> 选项来提供对导入的自定义查询，以供其他插件使用。</p><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">glob</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/*.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">query</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">foo</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">bar</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">bar</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// vite 生成的代码</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> modules </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/foo.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/foo.js?foo=bar&amp;bar=true</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">m</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> m</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">setup)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">./dir/bar.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./dir/bar.js?foo=bar&amp;bar=true</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">m</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> m</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">setup)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="glob-导入注意事项" tabindex="-1">Glob 导入注意事项 <a class="header-anchor" href="#glob-导入注意事项">¶</a></h3><p>请注意：</p><ul><li>这只是一个 Vite 独有的功能而不是一个 Web 或 ES 标准</li><li>该 Glob 模式会被当成导入标识符：必须是相对路径（以 <code>./</code> 开头）或绝对路径（以 <code>/</code> 开头，相对于项目根目录解析）或一个别名路径（请看 <a href="/booking/user-manual/config/shared-options.html#resolve-alias"><code>resolve.alias</code> 选项</a>)。</li><li>Glob 匹配是使用 <a href="https://github.com/mrmlnc/fast-glob" target="_blank" rel="noopener noreferrer">fast-glob</a> 来实现的 —— 阅读它的文档来查阅 <a href="https://github.com/mrmlnc/fast-glob#pattern-syntax" target="_blank" rel="noopener noreferrer">支持的 Glob 模式</a>。</li><li>你还需注意，所有 <code>import.<wbr>meta.glob</code> 的参数都必须以字面量传入。你 <strong>不</strong> 可以在其中使用变量或表达式。</li></ul><h2 id="dynamic-import" tabindex="-1">动态导入 <a class="header-anchor" href="#dynamic-import">¶</a></h2><p>和 <a href="#glob-import">glob 导入</a> 类似，Vite 也支持带变量的动态导入。</p><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> module </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">./dir/</span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">.js</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>注意变量仅代表一层深的文件名。如果 <code>file</code> 是 <code>foo/bar</code>，导入将会失败。对于更进阶的使用详情，你可以使用 <a href="#glob-import">glob 导入</a> 功能。</p><h2 id="webassembly" tabindex="-1">WebAssembly <a class="header-anchor" href="#webassembly">¶</a></h2><p>预编译的 <code>.wasm</code> 文件可以通过 <code>?init</code> 来导入。默认导出一个初始化函数，返回值为所导出 wasm 实例对象的 Promise：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> init </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./example.wasm?init</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">init</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">instance</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">instance</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">exports</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">test</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><code>init</code> 函数还可以将传递给 <code>WebAssembly.instantiate</code> 的导入对象作为其第二个参数：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#82AAFF;">init</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">imports</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">someFunc</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#676E95;font-style:italic;">/* ... */</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#676E95;font-style:italic;">/* ... */</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>在生产构建当中，体积小于 <code>assetInlineLimit</code> 的 <code>.wasm</code> 文件将会被内联为 base64 字符串。否则，它们将作为资源复制到 <code>dist</code> 目录中，并按需获取。</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p><a href="https://github.com/WebAssembly/esm-integration" target="_blank" rel="noopener noreferrer">对 WebAssembly 的 ES 模块集成提案</a> 尚未支持。 请使用 <a href="https://github.com/Menci/vite-plugin-wasm" target="_blank" rel="noopener noreferrer"><code>vite-plugin-wasm</code></a> 或其他社区上的插件来处理。</p></div><h2 id="web-workers" tabindex="-1">Web Workers <a class="header-anchor" href="#web-workers">¶</a></h2><h3 id="import-with-constructors" tabindex="-1">通过构造器导入 <a class="header-anchor" href="#import-with-constructors">¶</a></h3><p>一个 Web Worker 可以使用 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Worker/Worker" target="_blank" rel="noopener noreferrer"><code>new Worker()</code></a> 和 <a href="https://developer.mozilla.org/en-US/docs/Web/API/SharedWorker/SharedWorker" target="_blank" rel="noopener noreferrer"><code>new SharedWorker()</code></a> 导入。与 worker 后缀相比，这种语法更接近于标准，是创建 worker 的 <strong>推荐</strong> 方式。</p><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> worker </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Worker</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./worker.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">url))</span></span>
<span class="line"></span></code></pre></div><p>worker 构造函数会接受可以用来创建 “模块” worker 的选项：</p><div class="language-ts"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> worker </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Worker</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">URL</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./worker.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">url)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">type</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">module</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="import-with-query-suffixes" tabindex="-1">带有查询后缀的导入 <a class="header-anchor" href="#import-with-query-suffixes">¶</a></h3><p>你可以在导入请求上添加 <code>?worker</code> 或 <code>?sharedworker</code> 查询参数来直接导入一个 web worker 脚本。默认导出会是一个自定义 worker 的构造函数：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> MyWorker </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./worker?worker</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> worker </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MyWorker</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span></code></pre></div><p>Worker 脚本也可以使用 <code>import</code> 语句来替代 <code>importScripts()</code> —— 注意，在开发过程中，这依赖于浏览器原生支持，目前只在 Chrome 中适用，而在生产版本中，它已经被编译掉了。</p><p>默认情况下，worker 脚本将在生产构建中编译成单独的 chunk。如果你想将 worker 内联为 base64 字符串，请添加 <code>inline</code> 查询参数：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> MyWorker </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./worker?worker&amp;inline</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><p>如果你想要以一个 URL 的形式读取该 worker，请添加 <code>url</code> 这个 query：</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> MyWorker </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./worker?worker&amp;url</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><p>关于如何配置打包全部 worker，可以查看 <a href="/booking/user-manual/config/worker-options.html">Worker 选项</a> 了解更多相关细节。</p><h2 id="build-optimizations" tabindex="-1">构建优化 <a class="header-anchor" href="#build-optimizations">¶</a></h2><blockquote><p>下面所罗列的功能会自动应用为构建过程的一部分，除非你想禁用它们，否则没有必要显式配置。</p></blockquote><h3 id="css-code-splitting" tabindex="-1">CSS 代码分割 <a class="header-anchor" href="#css-code-splitting">¶</a></h3><p>Vite 会自动地将一个异步 chunk 模块中使用到的 CSS 代码抽取出来并为其生成一个单独的文件。这个 CSS 文件将在该异步 chunk 加载完成时自动通过一个 <code>&lt;link&gt;</code> 标签载入，该异步 chunk 会保证只在 CSS 加载完毕后再执行，避免发生 <a href="https://en.wikipedia.org/wiki/Flash_of_unstyled_content#:~:text=A%20flash%20of%20unstyled%20content,before%20all%20information%20is%20retrieved." target="_blank" rel="noopener noreferrer">FOUC</a> 。</p><p>如果你更倾向于将所有的 CSS 抽取到一个文件中，你可以通过设置 <a href="/booking/user-manual/config/build-options.html#build-csscodesplit"><code>build.cssCodeSplit</code></a> 为 <code>false</code> 来禁用 CSS 代码分割。</p><h3 id="preload-directives-generation" tabindex="-1">预加载指令生成 <a class="header-anchor" href="#preload-directives-generation">¶</a></h3><p>Vite 会为入口 chunk 和它们在打包出的 HTML 中的直接引入自动生成 <code>&lt;link rel=&quot;modulepreload&quot;&gt;</code> 指令。</p><h3 id="async-chunk-loading-optimization" tabindex="-1">异步 Chunk 加载优化 <a class="header-anchor" href="#async-chunk-loading-optimization">¶</a></h3><p>在实际项目中，Rollup 通常会生成 “共用” chunk —— 被两个或以上的其他 chunk 共享的 chunk。与动态导入相结合，会很容易出现下面这种场景：</p><figure class="svg-image-root"><svg viewBox="0 0 1440 495" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect y="191" width="315" height="146" rx="10" fill="#C3E88C"/>
<text fill="#15505C" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="40" font-weight="600" letter-spacing="0em"><tspan x="105.5" y="278.545">Entry</tspan></text>
<rect x="556" width="360" height="141" rx="10" fill="#C3E88C"/>
<text fill="#15505C" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="40" font-weight="600" letter-spacing="0em"><tspan x="594" y="85.0455">async chunk A</tspan></text>
<rect x="1080" y="169" width="360" height="141" rx="10" fill="#C3E88C"/>
<text fill="#15505C" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="40" font-weight="600" letter-spacing="0em"><tspan x="1091.5" y="254.045">common chunk C</tspan></text>
<rect x="556" y="354" width="360" height="141" rx="10" fill="#C3E88C"/>
<text fill="#15505C" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="40" font-weight="600" letter-spacing="0em"><tspan x="595.5" y="439.045">async chunk B</tspan></text>
<path d="M546.44 71.5452C546.741 70.1977 545.893 68.8613 544.545 68.5602L522.587 63.6533C521.239 63.3522 519.903 64.2004 519.602 65.5479C519.301 66.8954 520.149 68.2318 521.496 68.5329L541.015 72.8946L536.653 92.4132C536.352 93.7607 537.2 95.0971 538.548 95.3983C539.895 95.6994 541.232 94.8511 541.533 93.5036L546.44 71.5452ZM326.34 212.111L334.161 207.146L331.482 202.925L323.66 207.889L326.34 212.111ZM349.804 197.218L365.447 187.289L362.767 183.068L347.125 192.996L349.804 197.218ZM381.09 177.361L396.733 167.432L394.053 163.211L378.41 173.139L381.09 177.361ZM412.375 157.504L428.018 147.575L425.339 143.354L409.696 153.282L412.375 157.504ZM443.661 137.646L459.304 127.718L456.625 123.496L440.982 133.425L443.661 137.646ZM474.947 117.789L490.59 107.861L487.91 103.639L472.267 113.568L474.947 117.789ZM506.233 97.9322L521.875 88.0036L519.196 83.7821L503.553 93.7107L506.233 97.9322ZM537.518 78.075L545.34 73.1107L542.66 68.8893L534.839 73.8536L537.518 78.075ZM548.88 72.0904C549.482 69.3955 547.785 66.7226 545.09 66.1204L501.174 56.3065C498.479 55.7043 495.806 57.4008 495.203 60.0958C494.601 62.7907 496.298 65.4636 498.993 66.0658L538.03 74.7892L529.307 113.826C528.704 116.521 530.401 119.194 533.096 119.796C535.791 120.399 538.464 118.702 539.066 116.007L548.88 72.0904ZM327.679 214.221L335.501 209.257L330.142 200.814L322.321 205.779L327.679 214.221ZM351.144 199.329L366.787 189.4L361.428 180.957L345.785 190.886L351.144 199.329ZM382.429 179.471L398.072 169.543L392.713 161.1L377.071 171.029L382.429 179.471ZM413.715 159.614L429.358 149.686L423.999 141.243L408.356 151.171L413.715 159.614ZM445.001 139.757L460.644 129.829L455.285 121.386L439.642 131.314L445.001 139.757ZM476.287 119.9L491.929 109.971L486.571 101.529L470.928 111.457L476.287 119.9ZM507.572 100.043L523.215 90.1143L517.856 81.6714L502.213 91.6L507.572 100.043ZM538.858 80.1858L546.679 75.2215L541.321 66.7785L533.499 71.7428L538.858 80.1858Z" fill="#0B7285"/>
<path d="M544.718 442.395C546.04 441.998 546.791 440.605 546.395 439.282L539.935 417.729C539.539 416.407 538.145 415.656 536.823 416.052C535.5 416.449 534.749 417.842 535.146 419.165L540.888 438.323L521.729 444.065C520.407 444.461 519.656 445.855 520.052 447.177C520.449 448.5 521.842 449.251 523.165 448.854L544.718 442.395ZM323.814 324.201L331.636 328.415L334.007 324.013L326.186 319.799L323.814 324.201ZM347.278 336.844L362.921 345.272L365.293 340.871L349.65 332.442L347.278 336.844ZM378.564 353.701L394.207 362.129L396.579 357.728L380.936 349.299L378.564 353.701ZM409.85 370.558L425.493 378.987L427.864 374.585L412.222 366.156L409.85 370.558ZM441.136 387.415L456.778 395.844L459.15 391.442L443.507 383.013L441.136 387.415ZM472.421 404.272L488.064 412.701L490.436 408.299L474.793 399.871L472.421 404.272ZM503.707 421.129L519.35 429.558L521.722 425.156L506.079 416.728L503.707 421.129ZM534.993 437.987L542.814 442.201L545.186 437.799L537.364 433.585L534.993 437.987ZM545.435 444.79C548.081 443.997 549.582 441.21 548.79 438.565L535.871 395.459C535.078 392.814 532.291 391.312 529.646 392.105C527 392.898 525.499 395.685 526.292 398.33L537.775 436.646L499.459 448.129C496.814 448.922 495.312 451.709 496.105 454.354C496.898 457 499.685 458.501 502.33 457.708L545.435 444.79ZM322.628 326.402L330.45 330.616L335.193 321.813L327.372 317.598L322.628 326.402ZM346.093 339.045L361.735 347.473L366.479 338.67L350.836 330.241L346.093 339.045ZM377.378 355.902L393.021 364.33L397.765 355.527L382.122 347.098L377.378 355.902ZM408.664 372.759L424.307 381.187L429.05 372.384L413.407 363.955L408.664 372.759ZM439.95 389.616L455.593 398.045L460.336 389.241L444.693 380.813L439.95 389.616ZM471.235 406.473L486.878 414.902L491.622 406.098L475.979 397.67L471.235 406.473ZM502.521 423.33L518.164 431.759L522.907 422.955L507.265 414.527L502.521 423.33ZM533.807 440.187L541.628 444.402L546.372 435.598L538.55 431.384L533.807 440.187Z" fill="#0B7285"/>
<text fill="#0B7285" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="35" letter-spacing="0em"><tspan x="172" y="98.7273">dynamic import</tspan></text>
<text fill="#1864AB" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="35" letter-spacing="0em"><tspan x="1013" y="83.7273">direct import</tspan></text>
<path d="M1071.89 171.899C1074.05 171.404 1075.39 169.258 1074.9 167.105L1066.85 132.017C1066.35 129.864 1064.21 128.519 1062.05 129.014C1059.9 129.508 1058.55 131.654 1059.05 133.807L1066.21 164.996L1035.02 172.154C1032.86 172.648 1031.52 174.795 1032.01 176.948C1032.51 179.101 1034.65 180.446 1036.81 179.952L1071.89 171.899ZM918.876 77.3895L1068.88 171.389L1073.12 164.611L923.124 70.6105L918.876 77.3895Z" fill="#1864AB"/>
<path d="M1074.95 317.66C1075.31 315.481 1073.84 313.419 1071.66 313.055L1036.15 307.114C1033.97 306.75 1031.91 308.22 1031.55 310.399C1031.18 312.578 1032.65 314.64 1034.83 315.004L1066.39 320.285L1061.11 351.846C1060.75 354.025 1062.22 356.087 1064.4 356.452C1066.58 356.816 1068.64 355.345 1069 353.167L1074.95 317.66ZM923.323 427.256L1073.32 320.256L1068.68 313.744L918.677 420.744L923.323 427.256Z" fill="#1864AB"/>
</svg>
</figure><p>在无优化的情境下，当异步 chunk <code>A</code> 被导入时，浏览器将必须请求和解析 <code>A</code>，然后它才能弄清楚它也需要共用 chunk <code>C</code>。这会导致额外的网络往返：</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">Entry ---&gt; A ---&gt; C</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>Vite 将使用一个预加载步骤自动重写代码，来分割动态导入调用，以实现当 <code>A</code> 被请求时，<code>C</code> 也将 <strong>同时</strong> 被请求：</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">Entry ---&gt; (A + C)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><code>C</code> 也可能有更深的导入，在未优化的场景中，这会导致更多的网络往返。Vite 的优化会跟踪所有的直接导入，无论导入的深度如何，都能够完全消除不必要的往返。</p></div></div></main><footer class="VPDocFooter" data-v-6f5051a0 data-v-67e5d2c4><div class="edit-info" data-v-67e5d2c4><!----><!----></div><div class="prev-next" data-v-67e5d2c4><div class="pager" data-v-67e5d2c4><!----></div><div class="pager" data-v-67e5d2c4><a class="pager-link next" href="/booking/user-manual/guide/booking/intro.html" data-v-67e5d2c4><span class="desc" data-v-67e5d2c4>Next page</span><span class="title" data-v-67e5d2c4>系统介绍</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"readme.md\":\"90929eed\",\"blog_announcing-vite2.md\":\"c9bd1973\",\"blog_announcing-vite3.md\":\"c51c29bd\",\"config_build-options.md\":\"626e5825\",\"config_dep-optimization-options.md\":\"26604743\",\"config_index.md\":\"b5f753bc\",\"config_preview-options.md\":\"01950d50\",\"config_server-options.md\":\"3ddba7f2\",\"config_shared-options.md\":\"0eb3f6ef\",\"config_ssr-options.md\":\"49b01b36\",\"config_worker-options.md\":\"4bd710be\",\"guide_api-hmr.md\":\"74a2061b\",\"guide_api-javascript.md\":\"34366b97\",\"guide_api-plugin.md\":\"c5cc01f5\",\"guide_assets.md\":\"3de18e95\",\"guide_backend-integration.md\":\"288597cb\",\"guide_booking_concept.md\":\"296789b2\",\"guide_booking_demo-image.md\":\"695bb140\",\"guide_booking_features.md\":\"cc5a579c\",\"guide_booking_intro.md\":\"7832dd88\",\"guide_booking_other-info.md\":\"28540155\",\"guide_booking_start-using.md\":\"d0eca18d\",\"guide_build.md\":\"bd7e2c91\",\"guide_comparisons.md\":\"d7e88fa0\",\"guide_dep-pre-bundling.md\":\"69fe0a70\",\"guide_env-and-mode.md\":\"bd62836d\",\"guide_features.md\":\"55ece322\",\"guide_index.md\":\"36447c0d\",\"guide_migration-from-v1.md\":\"216200b7\",\"guide_migration.md\":\"a622b45f\",\"guide_ssr.md\":\"2ed34a99\",\"guide_static-deploy.md\":\"bce7f88b\",\"guide_troubleshooting.md\":\"e5ce2321\",\"guide_using-plugins.md\":\"4b33a6fc\",\"guide_why.md\":\"e2344372\",\"index.md\":\"33ffb58c\",\"plugins_index.md\":\"048f3c89\",\"team.md\":\"34326b11\"}")</script>
    <script type="module" async src="/booking/user-manual/assets/app.a7a08ac0.js"></script>
    
  </body>
</html>